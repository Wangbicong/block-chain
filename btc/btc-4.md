![Bitcoin-vs-BitcoinCash.png][1]

# 比特币的扩容问题
比特币是一项伟大的发明，但并非是个完美的发明。事实上任何技术都不可能在诞生的时候就是完美的，比特币存在的最大的问题之一就是**比特币的区块大小不得超过1M**。

比特币的区块大小起初并没有限制，后来随着发展中本聪为了防止粉尘攻击（大量低额交易）而设置的，这样的攻击会导致区块巨大，于是中本聪将区块大小限制在了1MB内。但是这样的限制导致了一个问题：一个区块的生成时间约为十分钟，而每个最基本交易的大小为250B，因此每十分钟可产生的比特币交易约为1024*1024/250 = 4194次。这就导致如果某十分钟产生的交易多于4194次，多出来的交易只能等到下一个区块再进行结算，就会造成交易的阻塞，只有手续费高的交易能够被结算。

在历史背景下，这样的限制也有一定的优势。这样的限制保证了每年比特币区块链的增长大小在50G以内。同时根据电子的**摩尔定律**，这样的增长量保证了个人节点都能存储完整的区块链信息。

> 摩尔定律是由英特尔创始人之一戈登·摩尔（Gordon Moore）提出来的。其内容为：当价格不变时，集成电路上可容纳的元器件的数目，约每隔18-24个月便会增加一倍，性能也将提升一倍。换言之，每一美元所能买到的电脑性能，将每隔18-24个月翻一倍以上。

但是随着比特币的流行程度变高，这个问题变得日益显著，已经是比特币必须要解决的问题，于是有人提出，比特币必须分叉。

# 比特币分叉
## 什么是比特币分叉
之前我们提到过，区块的生成并非像串糖葫芦一样简单。尽管挖矿非常复杂，但是必然存在多个矿机同时挖到矿（产生了符合条件的区块）的情况。这种情况下，由于这些区块都符合校验条件，所以其他矿机节点在收到的时候都不会拒绝，他们会做这样一件事：**保存多条链，但是始终在最长链上挖矿**。

如何理解这句话呢？我们用一组漫画来解释（友情感谢顶尖插画师 @Antler）。首先假设大家都在同样的区块链上挖347号区块。

![fork-1.jpg][2]

你在挖347号区块时，收到了别人在此链（我们定义为A链）已挖到347号区块的消息。

![fork-2.jpg][3]

你需要做的就是马上放弃347号，投身到挖348号的工作中。（表面笑嘻嘻，内心mmp)

![fork-3.jpg][4]

接着，你又收到了B链上的消息——有个人挖到了B链上的347号区块！

![fork-4.jpg][5]

此时你不知道未来的最长链到底是哪一条，唯一能做的事就是保留B链上的347区块（万一B链变成最长链了马上转移战场）。

![fork-5.jpg][6]

如果非常不幸，你又收到了B链上348区块已被挖出的消息。

![fork-6.jpg][7]

那就放弃A链吧，它已经落后于时代了。

![fork-7.jpg][8]

开始加入B链（目前最长链）的挖矿工作中。（老大可能气到关闭了矿机所以没有来）

![fork-8.jpg][9]

但是，这样的分叉其实并不会影响区块链的正常运行，因为随着时间的流逝，总会有条链成为最长链，这条便是大多数矿机认可的链。为什么不存在两条链同时增长的情况呢？你可以这样简单理解：挖矿难度很大，多个矿机同时挖到矿的概率极低，而这个事件不断同时发生才会出现两条链同时增长的情况，只要断点就会让另一条链长度变长。

另外，比特币协议发生改变后也会造成分叉，分为**软分叉**和**硬分叉**。我们本篇文章只讨论硬分叉。

## 什么是硬分叉
硬分叉是一种很强硬的分叉，新的协议不再兼容旧的矿机，矿机只能通过升级协议才能在新的链上挖矿，否则新旧矿机会因为协议冲突导致他们对区块无法达成共识，进而分道扬镳，**在两条链上各自挖矿**。

## 比特币现金 vs 比特币
事实上，比特币已经发生过分叉，还不止一次。历史上最轰轰烈烈的硬分叉是BCH（比特币现金），其官方网站上记录了分叉点：

> 所有于区块高度 478558 时比特币的拥有者，也是比特币现金的拥有者。

在区块478558前，比特币和比特币现金共用相同的区块链，新的协议比特币现金接受了所有比特币拥有者的财富，遵照原比特币协议按照1：1兑换，也就是说在那个区块前拥有比特币的人将免费获得一份比特币现金。

同时，比特币现金宣传自己拥有新功能：

> 链上扩容 - 比特币现金遵循中本聪通过链上扩容实现全球普及的路线图。作为第一步，区块大小限制已被设为可调整，默认提升到了 8MB 。 允许未来大幅提升区块容量的研究正在进行 。
> 
> 新的交易签名 - 新的签名哈希 (SigHash) 类型提供了重放攻击保护、改善了硬件钱包安全性，也解决了二次哈希问题。
> 
> 新的难度调整算法(DAA) - 响应式的工作量证明(PoW) 难度调整允许矿工按其意愿从旧的比特币链迁移至新链，同时提供保护抑制算力过度波动。
> 
> 去中心化的开发 - 有数个独立开发团队提供的软件实现，未来是安全的。比特币现金能够抵御在协议开发上的政治和社交攻击，没有单独的团队或项目能控制。 bitcoin-ml 邮件列表是一个好的平台，用于跨发开团队协作以实现协议变更。

先不用在意那些专业术语，最重要的一点是第一条，比特币现金对区块大小进行了扩容，这样就一定程度上解决了我们之前提到的比特币交易阻塞问题，也成功降低了交易手续费。

## 比特币真的需要分叉吗
听上去皆大欢喜是吗？事实上这些都基于前文那句话：“于是有人提出，比特币必须分叉”。那么，比特币真的必须分叉吗？更进一步说，比特币真的必须硬分叉吗？起码，比特币的核心开发团队（Bitcoin Core）不这么想，这个团队是一群水平非常高的技术人员，同时也是中本聪的追随者，他们认为比特币不能发生硬分叉，因为区块的扩大无法从根本上解决交易阻塞问题，随着比特币用户的增多，把区块大小从1M到2M仍旧无法满足需求，需要一扩再扩，直到普通人已经无法再运行其整个区块链，区块链又将被掌握在中心化系统的手里，这样完全违背了区块链的初衷。

Core团队提出的改进方式之一是**闪电网络**，基本的思想是尽量不修改比特币本身的协议，而是用外部拓展的方式。只在比特币区块链上发起少量特定的交易，而其他众多交易在第二层闪电网络中进行。

事实上，我认为**比特币现金VS闪电网络**从不同的角度提出比特币交易拥堵的技术方案，他们之前的共识是**比特币需要被拯救**，不同点主要在于对**区块大小**的争论。然而，真实的争论远比我描述的要复杂与激烈。两方甚至多方对于如何解决拥堵问题上提出过很多解决方案，最终才化为两大派。现在把控言论更多的是BCH的支持方，这些支持方的领袖是矿主群体，把Core团队描述成保守党，把控着比特币而不愿意听从人民的声音。而Core团队的支持者把矿主们描述成矿霸，把控着挖矿权进而操纵民意。有过多次不成功的握手言和，争论一直在继续。

从情感上判断，我更愿意相信Core团队的节操，而不太相信矿主们的言论。但是作为技术传播者，我不太想用自己先入为主观念影响读者的判断，仁者见仁。毕竟，从这些争论中我们可以看出，比特币的未来还有很长一段路需要走。

  [1]: http://blockchain8.tech/usr/uploads/2018/03/1293805139.png
  [2]: http://blockchain8.tech/usr/uploads/2018/03/517452621.jpg
  [3]: http://blockchain8.tech/usr/uploads/2018/03/420768234.jpg
  [4]: http://blockchain8.tech/usr/uploads/2018/03/1717005367.jpg
  [5]: http://blockchain8.tech/usr/uploads/2018/03/1260109432.jpg
  [6]: http://blockchain8.tech/usr/uploads/2018/03/1221225405.jpg
  [7]: http://blockchain8.tech/usr/uploads/2018/03/2338752224.jpg
  [8]: http://blockchain8.tech/usr/uploads/2018/03/2244333152.jpg
  [9]: http://blockchain8.tech/usr/uploads/2018/03/3142499959.jpg